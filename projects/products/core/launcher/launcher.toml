[workspace]
# chemin relatif depuis ce fichier (launcher/) vers la racine workspace core/
root = ".."

[build]
enabled = true
profile = "debug" # debug|release
# args supplémentaires si besoin:
extra_args = ["--bins"]

[launcher]
# global
startup_timeout_ms = 15000
shutdown_grace_ms = 2500

[[service]]
name = "watcher"
bin = "watcher"
args = []
env = []
cwd = ".."                                  # relatif au workspace root
depends_on = []
restart = "on-failure"                      # never|on-failure|always
restart_max = 10
restart_backoff_ms = 500
ready_http = "http://127.0.0.1:8081/health"

[[service]]
name = "api"
bin = "api"
args = ["--port", "8080"]
env = ["RUST_LOG=info"]
cwd = ".."
depends_on = ["watcher"]
restart = "always"
restart_max = 0                             # 0 = illimité
restart_backoff_ms = 800
ready_http = "http://127.0.0.1:8080/health"

[[service]]
name = "scheduler"
bin = "scheduler"
args = []
env = []
cwd = ".."
depends_on = ["api"]
restart = "on-failure"
restart_max = 5
restart_backoff_ms = 1000
# pas de healthcheck => considère ready dès le spawn
