[workspace]
# Relative path from this file (launcher/) to repository root
root = "../../../../.."

[build]
enabled = true
profile = "debug" # debug|release
# Additional arguments if needed:
extra_args = ["--bins"]

[launcher]
# Global settings
startup_timeout_ms = 15000
shutdown_grace_ms = 2500

[[service]]
name = "engine"
bin = "engine"
args = []
env = [
  "RUST_LOG=info",
  "ENGINE_ALLOW_INSECURE_SECRET=1",
  "ENGINE_OWNER_CLAIM_DIR=/tmp/automation_engine_claim",
  "ENGINE_PROJECTS_DIR=projects/products/stable",
]
depends_on = []
restart = "on-failure"
restart_max = 10
restart_backoff_ms = 500
ready_http = "http://127.0.0.1:3030/health"

[[service]]
name = "watcher"
bin = "watcher"
args = []
env = [
  "RUST_LOG=info",
]
depends_on = ["engine"]
restart = "on-failure"
restart_max = 10
restart_backoff_ms = 500

[[service]]
name = "central_ui"
bin = "central_ui"
args = []
env = [
  "RUST_LOG=info",
  "CENTRAL_UI_ENGINE_HTTP=http://127.0.0.1:3030",
]
depends_on = ["engine", "watcher"]
restart = "on-failure"
restart_max = 5
restart_backoff_ms = 1000
ready_http = "http://127.0.0.1:7171/api/setup/status"
